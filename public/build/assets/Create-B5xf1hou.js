import{u as F,r as g,b as M,j as e,H as O,L as q}from"./app-Cv3QELsD.js";import{A as G}from"./AuthenticatedLayout-B0rF1LC0.js";/* empty css            */import"./transition-2rVswJNR.js";function H(){const{basePath:c="admin",flash:u={}}=F().props,[d,m]=g.useState(u.success||null),[i,p]=g.useState("bg-green-600"),[j,f]=g.useState(!1),[y,k]=g.useState(null),{data:t,setData:s,processing:_,errors:h,post:w,reset:C}=M({full_name:"",phone:"",email:"",marital_status:"",gender:"",house_no:"",community:"",location:"",district:"",postal_address:"",workplace:"",profession:"",employer:"",bank:"",bank_branch:"",has_bank_loan:!1,bank_monthly_deduction:"",take_home:"",loan_amount_requested:"",loan_purpose:"",status:"inactive",guarantors:[{name:"",occupation:"",residence:"",contact:""}],agreement:null}),V=()=>s("guarantors",[...t.guarantors,{name:"",occupation:"",residence:"",contact:""}]),S=a=>s("guarantors",t.guarantors.filter((n,l)=>l!==a)),b=(a,n,l)=>{const o=[...t.guarantors];o[a][n]=l,s("guarantors",o)},A=a=>{a.preventDefault();const n=new FormData;Object.entries(t).forEach(([l,o])=>{l==="guarantors"?o.forEach((E,P)=>{Object.entries(E).forEach(([D,N])=>{N&&n.append(`guarantors[${P}][${D}]`,N)})}):l==="agreement"&&o?n.append("agreement",o):n.append(l,o??"")}),w(route(`${c}.customers.store`),{data:n,forceFormData:!0,onSuccess:l=>{const o=l?.props?.flash?.customer;p("bg-green-600"),m("âœ… Customer created successfully!"),k(o||null),f(!0),C()},onError:l=>{p("bg-red-600");const o=l&&Object.values(l)?.[0]?Array.isArray(Object.values(l)[0])?Object.values(l)[0][0]:Object.values(l)[0]:"âš ï¸ Please check highlighted fields.";m(o)}})};return e.jsxs(G,{header:e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"New Customer"}),children:[e.jsx(O,{title:"Create Customer"}),d&&e.jsx("div",{className:`fixed top-5 right-5 z-50 ${i} text-white px-4 py-3 rounded-lg shadow-lg transition-opacity duration-300`,children:d}),e.jsx("div",{className:"py-8 max-w-5xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("form",{onSubmit:A,className:"space-y-6 bg-white shadow-lg rounded-lg p-6",children:[e.jsx(x,{title:"Personal Details",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(r,{label:"Full Name *",value:t.full_name,setValue:a=>s("full_name",a),error:h.full_name,required:!0}),e.jsx(r,{label:"Phone",value:t.phone,setValue:a=>s("phone",a),error:h.phone}),e.jsx(r,{label:"Email",value:t.email,setValue:a=>s("email",a),error:h.email}),e.jsx(v,{label:"Marital Status",value:t.marital_status,setValue:a=>s("marital_status",a),options:[{value:"",label:"â€”"},{value:"single",label:"Single"},{value:"married",label:"Married"}]}),e.jsx(v,{label:"Gender",value:t.gender,setValue:a=>s("gender",a),options:[{value:"",label:"â€”"},{value:"F",label:"Female"},{value:"M",label:"Male"}]}),e.jsx(v,{label:"Status",value:t.status,setValue:a=>s("status",a),options:[{value:"inactive",label:"Inactive"},{value:"active",label:"Active"},{value:"suspended",label:"Suspended"}]})]})}),e.jsx(x,{title:"Address",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(r,{label:"House No.",value:t.house_no,setValue:a=>s("house_no",a)}),e.jsx(r,{label:"Community",value:t.community,setValue:a=>s("community",a)}),e.jsx(r,{label:"Location",value:t.location,setValue:a=>s("location",a)}),e.jsx(r,{label:"District",value:t.district,setValue:a=>s("district",a)}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(r,{label:"Postal Address",value:t.postal_address,setValue:a=>s("postal_address",a)})})]})}),e.jsx(x,{title:"Work & Income",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(r,{label:"Workplace",value:t.workplace,setValue:a=>s("workplace",a)}),e.jsx(r,{label:"Profession",value:t.profession,setValue:a=>s("profession",a)}),e.jsx(r,{label:"Employer",value:t.employer,setValue:a=>s("employer",a)}),e.jsx(r,{label:"Bank",value:t.bank,setValue:a=>s("bank",a)}),e.jsx(r,{label:"Bank Branch",value:t.bank_branch,setValue:a=>s("bank_branch",a)}),e.jsxs("label",{className:"inline-flex items-center gap-2 text-sm mt-6 text-gray-700",children:[e.jsx("input",{type:"checkbox",checked:t.has_bank_loan,onChange:a=>s("has_bank_loan",a.target.checked)}),"Has bank loan"]}),e.jsx(r,{type:"number",label:"Bank Monthly Deduction (â‚µ)",value:t.bank_monthly_deduction,setValue:a=>s("bank_monthly_deduction",a)}),e.jsx(r,{type:"number",label:"Take-home Salary (â‚µ)",value:t.take_home,setValue:a=>s("take_home",a)})]})}),e.jsx(x,{title:"Loan Request",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(r,{type:"number",label:"Amount Requested (â‚µ)",value:t.loan_amount_requested,setValue:a=>s("loan_amount_requested",a)}),e.jsx(r,{label:"Purpose",value:t.loan_purpose,setValue:a=>s("loan_purpose",a)})]})}),e.jsxs(x,{title:"Guarantors",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsx("button",{type:"button",onClick:V,className:"px-3 py-1.5 bg-gray-800 hover:bg-gray-900 text-white rounded-md font-semibold transition",children:"+ Add Guarantor"})}),t.guarantors.map((a,n)=>e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-3",children:[e.jsx("input",{className:"input",placeholder:"Name *",value:a.name,onChange:l=>b(n,"name",l.target.value),required:!0}),e.jsx("input",{className:"input",placeholder:"Occupation",value:a.occupation,onChange:l=>b(n,"occupation",l.target.value)}),e.jsx("input",{className:"input",placeholder:"Residence",value:a.residence,onChange:l=>b(n,"residence",l.target.value)}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{className:"input flex-1",placeholder:"Contact",value:a.contact,onChange:l=>b(n,"contact",l.target.value)}),n>0&&e.jsx("button",{type:"button",onClick:()=>S(n),className:"px-3 rounded border text-sm text-gray-700 border-gray-300 hover:bg-gray-100",children:"Remove"})]})]},n))]}),e.jsxs(x,{title:"Agreement / Attachment",children:[e.jsx("input",{type:"file",accept:"application/pdf,image/*",onChange:a=>s("agreement",a.target.files?.[0]??null),className:"text-gray-700"}),h.agreement&&e.jsx("p",{className:"error",children:h.agreement})]}),e.jsxs("div",{className:"flex justify-between items-center pt-2 border-t",children:[e.jsx(q,{href:route(`${c}.customers.index`),className:"text-gray-600 hover:underline",children:"â† Back"}),e.jsx("button",{type:"submit",disabled:_,className:"px-6 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50 transition",children:_?"Saving...":"Save Customer"})]})]})}),j&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6 text-center",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-3",children:"ðŸŽ‰ Customer Created Successfully!"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"What would you like to do next?"}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-center gap-3",children:[e.jsx("button",{onClick:()=>window.location.href=route(`${c}.loans.create`,{customer_id:y?.id,client_name:y?.full_name}),className:"px-5 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Create Loan"}),e.jsx("button",{onClick:()=>f(!1),className:"px-5 py-2 bg-gray-300 text-gray-800 rounded hover:bg-gray-400",children:"Add Another"})]})]})}),e.jsx("style",{children:`
        .input {
          width: 100%;
          border: 1px solid #d1d5db;
          border-radius: .375rem;
          padding: .5rem .75rem;
          background: white;
          color: #111827;
          box-shadow: 0 2px 6px rgba(0,0,0,0.06);
        }
        .error {
          color: #ef4444;
          font-size: .875rem;
          margin-top: .25rem;
        }
      `})]})}function r({label:c,value:u,setValue:d,type:m="text",error:i,required:p}){return e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm text-gray-700",children:[c,p&&e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{className:"input",type:m,value:u,onChange:j=>d(j.target.value),required:p}),i&&e.jsx("p",{className:"error",children:i})]})}function v({label:c,value:u,setValue:d,options:m}){return e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700",children:c}),e.jsx("select",{className:"input",value:u,onChange:i=>d(i.target.value),children:m.map(i=>e.jsx("option",{value:i.value,children:i.label},i.value))})]})}function x({title:c,children:u}){return e.jsxs("section",{children:[e.jsx("h3",{className:"font-semibold mb-2 text-gray-800",children:c}),u]})}export{H as default};
