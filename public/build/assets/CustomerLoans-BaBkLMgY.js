import{u as w,r as p,b as _,j as e,H as S,L as x}from"./app-CsPuMaPE.js";import{A as L}from"./AuthenticatedLayout-DLvna0tA.js";/* empty css            */import"./transition-Bs_woZCa.js";const h=s=>`₵${Number(s??0).toFixed(2)}`,g=s=>s?new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"—";function $(){const{customer:s,loans:n=[],auth:l={},flash:a={},basePath:r="admin"}=w().props,y=["admin","staff","superadmin"].includes(l?.user?.role)||l?.is_super_admin,[o,b]=p.useState(null),[f,c]=p.useState(!1),{data:d,setData:i,post:j,processing:u,reset:N,errors:D}=_({amount:"",paid_at:new Date().toISOString().split("T")[0],reference:"",note:""}),v=t=>{t.preventDefault(),o&&j(route(`${r}.loans.payment`,o.id),{preserveScroll:!0,onSuccess:()=>{N(),c(!1)}})};return e.jsxs(L,{header:e.jsxs("h2",{className:"text-xl font-semibold text-gray-800",children:["Loans for ",s.full_name]}),children:[e.jsx(S,{title:`Loans for ${s.full_name}`}),e.jsxs("div",{className:"py-8 max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 space-y-6",children:[a?.success&&e.jsx("div",{className:"bg-green-100 text-green-800 px-4 py-2 rounded shadow",children:a.success}),a?.error&&e.jsx("div",{className:"bg-red-100 text-red-800 px-4 py-2 rounded shadow",children:a.error}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(x,{href:route(`${r}.loans.index`),className:"text-gray-600 hover:underline",children:"← Back to All Loans"}),e.jsxs(x,{href:route(`${r}.loans.create`,{client_name:s.full_name,customer_id:s.id}),className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 shadow",children:["+ Create New Loan for ",s.full_name]})]}),e.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:["Loan History (",n.length,")"]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-800",children:e.jsx("tr",{children:["Loan ID","Amount","Interest","Start Date","Due Date","Status","Remaining","Actions"].map(t=>e.jsx("th",{className:"px-4 py-2 text-left text-sm font-semibold",children:t},t))})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:n.length?n.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50 transition",children:[e.jsxs("td",{className:"px-4 py-2 text-sm",children:["#",t.id]}),e.jsx("td",{className:"px-4 py-2 text-sm",children:h(t.amount)}),e.jsxs("td",{className:"px-4 py-2 text-sm",children:[t.interest_rate,"%"]}),e.jsx("td",{className:"px-4 py-2 text-sm",children:g(t.start_date)}),e.jsx("td",{className:"px-4 py-2 text-sm",children:g(t.due_date)}),e.jsx("td",{className:"px-4 py-2 text-sm capitalize",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-semibold ${t.status==="active"?"bg-blue-100 text-blue-700":t.status==="paid"?"bg-green-100 text-green-700":t.status==="pending"?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:t.status})}),e.jsx("td",{className:"px-4 py-2 text-sm",children:h(t.amount_remaining)}),e.jsxs("td",{className:"px-4 py-2 text-sm flex gap-2",children:[e.jsx(x,{href:route(`${r}.loans.show`,t.id),className:"text-blue-600 hover:underline",children:"View"}),y&&t.status==="active"&&e.jsx("button",{onClick:()=>{b(t),c(!0)},className:"text-green-600 hover:underline",children:"Record Payment"})]})]},t.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"8",className:"text-center py-6 text-gray-600",children:"No loans found for this customer."})})})]})})]})]}),f&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-full max-w-lg p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:["Record Payment for Loan #",o?.id]}),e.jsxs("form",{onSubmit:v,className:"space-y-4",children:[e.jsx(m,{label:"Amount (₵)",type:"number",value:d.amount,onChange:t=>i("amount",t.target.value),required:!0}),e.jsx(m,{label:"Payment Date",type:"date",value:d.paid_at,onChange:t=>i("paid_at",t.target.value),required:!0}),e.jsx(m,{label:"Reference (optional)",type:"text",value:d.reference,onChange:t=>i("reference",t.target.value),placeholder:"Txn ID or receipt number"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Note (optional)"}),e.jsx("textarea",{rows:"3",value:d.note,onChange:t=>i("note",t.target.value),className:"mt-1 block w-full border rounded-md p-2 text-gray-800",placeholder:"Any additional info about this payment…"})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[e.jsx("button",{type:"button",onClick:()=>c(!1),className:"px-4 py-2 border border-gray-300 rounded text-gray-700 hover:bg-gray-100",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:u,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50",children:u?"Saving...":"Save Payment"})]})]})]})})]})}function m({label:s,type:n="text",value:l,onChange:a,required:r}){return e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:s}),e.jsx("input",{type:n,value:l,onChange:a,required:r,className:"mt-1 block w-full border rounded-md p-2 text-gray-800 bg-white"})]})}export{$ as default};
