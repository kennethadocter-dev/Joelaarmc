import{u as L,r as u,a as c,j as e,H as _,L as f}from"./app-Cv3QELsD.js";import{A as C}from"./AuthenticatedLayout-B0rF1LC0.js";/* empty css            */import"./transition-2rVswJNR.js";function k(){const{loans:m=[],filters:p={},summary:s={},auth:j={},basePath:n="admin"}=L().props,h=j?.user||{},[i,g]=u.useState(p.client||""),[l,a]=u.useState(p.status||""),v=["admin","staff","officer","superadmin"].includes(h?.role)||h?.is_super_admin;u.useEffect(()=>{const t=setTimeout(()=>{c.get(route(`${n}.loans.index`),{client:i||void 0,status:l||void 0},{preserveState:!0,replace:!0})},400);return()=>clearTimeout(t)},[i,l]);const x=t=>`₵${Number(t??0).toFixed(2)}`,y=t=>t?new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"—",w=t=>{if(!t)return null;const r=new Date(t),o=Math.floor((new Date-r)/(1e3*60*60*24));return o>0?o:null},d=({title:t,sub:r,count:b=0,sum:o=0,onView:S})=>e.jsxs("div",{className:"bg-white rounded-xl shadow-md hover:shadow-lg transition transform hover:scale-[1.02] w-64 p-5 flex flex-col gap-2 border border-gray-100",children:[e.jsx("div",{className:"text-sm font-medium text-gray-500",children:t}),e.jsx("div",{className:"text-2xl font-bold text-gray-800",children:b}),e.jsxs("div",{className:"text-sm text-gray-600",children:[r,": ",x(o)]}),e.jsx("button",{onClick:S,className:"mt-2 px-3 py-1.5 text-sm font-semibold rounded-md bg-gray-800 text-white hover:bg-black transition",children:"View All"})]}),N=t=>{switch(t){case"active":return"bg-blue-100 text-blue-700";case"paid":return"bg-green-100 text-green-700";case"pending":return"bg-yellow-100 text-yellow-700";case"overdue":return"bg-red-100 text-red-700";default:return"bg-gray-100 text-gray-700"}},A=t=>{confirm("Activate this loan?")&&c.post(route(`${n}.loans.activate`,t),{},{onSuccess:()=>{c.reload({only:["loans"]}),alert("✅ Loan activated successfully!")},onError:()=>alert("❌ Failed to activate. Please try again.")})};return e.jsxs(C,{header:e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"All Loans"}),children:[e.jsx(_,{title:"All Loans"}),e.jsxs("div",{className:"py-8 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 space-y-8",children:[e.jsx("div",{className:"flex overflow-x-auto gap-6 pb-4 scrollbar-hide",children:e.jsxs("div",{className:"flex flex-nowrap space-x-6 min-w-max",children:[e.jsx(d,{title:"Active Loans",sub:"Total Amount",count:s?.active?.count||0,sum:s?.active?.sum||0,onView:()=>a("active")}),e.jsx(d,{title:"Pending Loans",sub:"Total Amount",count:s?.pending?.count||0,sum:s?.pending?.sum||0,onView:()=>a("pending")}),e.jsx(d,{title:"Paid Loans",sub:"Total Amount",count:s?.paid?.count||0,sum:s?.paid?.sum||0,onView:()=>a("paid")}),e.jsx(d,{title:"Overdue Loans",sub:"Total Amount",count:s?.overdue?.count||0,sum:s?.overdue?.sum||0,onView:()=>a("overdue")})]})}),e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3 w-full md:w-auto flex-wrap",children:[e.jsxs("select",{value:l,onChange:t=>a(t.target.value),className:"border border-gray-300 rounded-md px-3 py-2 text-sm bg-white text-gray-800",children:[e.jsx("option",{value:"",children:"All statuses"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"paid",children:"Paid"}),e.jsx("option",{value:"overdue",children:"Overdue"})]}),e.jsx("input",{type:"text",placeholder:"Search by client name...",value:i,onChange:t=>g(t.target.value),className:"border border-gray-300 rounded-md px-3 py-2 text-sm w-full md:w-64 bg-white text-gray-800"}),(l||i)&&e.jsx("button",{onClick:()=>{a(""),g(""),c.get(route(`${n}.loans.index`),{},{replace:!0})},className:"px-3 py-2 text-sm font-semibold rounded-md bg-gray-800 text-white hover:bg-black shadow transition",children:"Clear Filters ✨"})]}),v&&e.jsx(f,{href:route(`${n}.customers.index`),className:"px-4 py-2 bg-green-600 text-white rounded font-semibold hover:bg-green-700 shadow transition",children:"+ New Loan (Select Customer)"})]}),e.jsx("div",{className:"overflow-x-auto bg-white rounded-lg shadow border border-gray-200",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-100",children:e.jsx("tr",{children:["ID","Client Name","Amount","Interest","Term","Start Date","Due Date","Status","Remaining","Actions"].map(t=>e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-800",children:t},t))})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:m.length?m.map(t=>{const r=w(t.due_date);return e.jsxs("tr",{className:`hover:bg-gray-50 transition ${t.status==="overdue"?"bg-red-50":""}`,children:[e.jsxs("td",{className:"px-4 py-3 text-sm",children:["#",t.id]}),e.jsx("td",{className:"px-4 py-3 text-sm",children:t.client_name||"—"}),e.jsx("td",{className:"px-4 py-3 text-sm",children:x(t.amount)}),e.jsxs("td",{className:"px-4 py-3 text-sm",children:[t.interest_rate,"%"]}),e.jsx("td",{className:"px-4 py-3 text-sm",children:t.term_months}),e.jsx("td",{className:"px-4 py-3 text-sm",children:y(t.start_date)}),e.jsx("td",{className:"px-4 py-3 text-sm",children:t.due_date?e.jsxs(e.Fragment,{children:[y(t.due_date),r&&e.jsxs("span",{className:"ml-1 text-xs text-red-600",children:["(",r," ","days overdue)"]})]}):"—"}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-semibold ${N(t.status)}`,children:t.status})}),e.jsx("td",{className:"px-4 py-3 text-sm",children:x(t.amount_remaining??0)}),e.jsxs("td",{className:"px-4 py-3 text-sm flex flex-wrap gap-2",children:[e.jsx(f,{href:route(`${n}.loans.show`,t.id),className:"text-blue-600 hover:underline",children:"View"}),v&&t.status==="pending"&&e.jsx("button",{onClick:()=>A(t.id),className:"px-3 py-1 bg-blue-600 text-white rounded hover:bg-blue-700 transition",children:"Activate"})]})]},t.id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:"10",className:"text-center py-6 text-gray-600",children:"No loans found."})})})]})})]})]})}export{k as default};
